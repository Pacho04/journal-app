{"ast":null,"code":"import _objectSpread from\"/home/david/Escritorio/React/08-journal-app-19/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/david/Escritorio/React/08-journal-app-19/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/david/Escritorio/React/08-journal-app-19/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{db}from\"../firebase/firebase-config\";import{loadNotes}from\"../helpers/loadNotes\";import{types}from\"../types/types\";import Swal from'sweetalert2';import{fileUpload}from\"../helpers/fileUpload\";export var startNewNote=function startNewNote(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch,getState){var uid,newNote,doc;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:uid=getState().auth.uid;newNote={title:'',body:'',date:new Date().getTime()};_context.next=4;return db.collection(\"\".concat(uid,\"/journal/notes\")).add(newNote);case 4:doc=_context.sent;dispatch(activeNote(doc.id,newNote));dispatch(addNewNote(doc.id,newNote));case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();};export var activeNote=function activeNote(id,note){return{type:types.notesActive,payload:_objectSpread({id:id},note)};};export var addNewNote=function addNewNote(id,note){return{type:types.notesAddNew,payload:_objectSpread({id:id},note)};};export var startLoadingNotes=function startLoadingNotes(uid){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var notes;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return loadNotes(uid);case 2:notes=_context2.sent;dispatch(setNote(notes));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref2.apply(this,arguments);};}();};export var setNote=function setNote(notes){return{type:types.notesLoad,payload:notes};};export var startSaveNote=function startSaveNote(note){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch,getState){var uid,noteToFirestore;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:uid=getState().auth.uid;if(!note.url){delete note.url;}noteToFirestore=_objectSpread({},note);delete noteToFirestore.id;_context3.next=6;return db.doc(\"\".concat(uid,\"/journal/notes/\").concat(note.id)).update(noteToFirestore);case 6:dispatch(refreshNote(note.id,noteToFirestore));Swal.fire('Saved',note.title,'success');case 8:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x4,_x5){return _ref3.apply(this,arguments);};}();};export var refreshNote=function refreshNote(id,note){return{type:types.notesUpdate,payload:{id:id,note:_objectSpread({id:id},note)}};};export var startUploading=function startUploading(file){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,getState){var activeNote,fileUrl;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:activeNote=getState().notes.active;Swal.fire({title:'Uploading...',text:'Please wait...',allowOutsideClick:false,onBeforeOpen:function onBeforeOpen(){Swal.showLoading();}});_context4.next=4;return fileUpload(file);case 4:fileUrl=_context4.sent;activeNote.url=fileUrl;dispatch(startSaveNote(activeNote));Swal.close();case 8:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x6,_x7){return _ref4.apply(this,arguments);};}();};export var startDeleting=function startDeleting(id){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch,getState){var uid;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:uid=getState().auth.uid;_context5.next=3;return db.doc(\"\".concat(uid,\"/journal/notes/\").concat(id)).delete();case 3:dispatch(deleteNote(id));case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x8,_x9){return _ref5.apply(this,arguments);};}();};export var deleteNote=function deleteNote(id){return{type:types.notesDelete,payload:id};};export var noteLogout=function noteLogout(){return{type:types.notesLogoutCleaning};};","map":{"version":3,"sources":["/home/david/Escritorio/React/08-journal-app-19/src/actions/notes.js"],"names":["db","loadNotes","types","Swal","fileUpload","startNewNote","dispatch","getState","uid","auth","newNote","title","body","date","Date","getTime","collection","add","doc","activeNote","id","addNewNote","note","type","notesActive","payload","notesAddNew","startLoadingNotes","notes","setNote","notesLoad","startSaveNote","url","noteToFirestore","update","refreshNote","fire","notesUpdate","startUploading","file","active","text","allowOutsideClick","onBeforeOpen","showLoading","fileUrl","close","startDeleting","delete","deleteNote","notesDelete","noteLogout","notesLogoutCleaning"],"mappings":"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","sourcesContent":["import { db } from \"../firebase/firebase-config\";\nimport { loadNotes } from \"../helpers/loadNotes\";\nimport { types } from \"../types/types\";\nimport Swal from 'sweetalert2';\nimport { fileUpload } from \"../helpers/fileUpload\";\n\n\nexport const startNewNote = () =>{\n    return async(dispatch, getState) => {\n\n        const  {uid} = getState().auth;\n\n        const newNote = {\n            title: '',\n            body: '',\n            date: new Date().getTime()\n        }\n\n        const doc = await db.collection(`${uid}/journal/notes`).add(newNote);\n\n        dispatch(activeNote(doc.id, newNote));\n        dispatch(addNewNote(doc.id, newNote));\n\n    }\n}\n\nexport const activeNote = (id, note) => ({\n    type: types.notesActive,\n    payload: {\n        id,\n        ...note\n    }\n});\n\nexport const addNewNote = (id, note) => ({\n    type: types.notesAddNew,\n    payload: {\n        id, ...note\n    }\n})\n\nexport const startLoadingNotes = (uid) => {\n    return async(dispatch) => {\n        const notes = await loadNotes(uid);\n        dispatch(setNote(notes));\n    }\n}\n\nexport const setNote = (notes) => ({\n    type: types.notesLoad,\n    payload: notes\n});\n\nexport const startSaveNote = (note) => {\n\n    return async(dispatch, getState) => {\n\n        const  {uid} = getState().auth;\n\n        if(!note.url){\n            delete note.url;\n        }\n\n        const noteToFirestore = {...note};\n        delete noteToFirestore.id;\n\n        await db.doc(`${uid}/journal/notes/${note.id}`).update(noteToFirestore);\n\n        dispatch(refreshNote(note.id, noteToFirestore));\n\n        Swal.fire('Saved', note.title, 'success');\n\n    }\n\n}\n\nexport const refreshNote = (id, note) => ({\n    type: types.notesUpdate,\n    payload: {\n        id, \n        note: {\n            id,\n            ...note\n        }\n    }\n});\n\nexport const startUploading = (file) => {\n    return async(dispatch, getState) => {\n        const {active:activeNote} = getState().notes;\n        \n        Swal.fire({\n            title: 'Uploading...',\n            text: 'Please wait...',\n            allowOutsideClick: false,\n            onBeforeOpen: () => {\n                Swal.showLoading();\n            }\n        });\n        \n        const fileUrl = await fileUpload(file);\n        activeNote.url = fileUrl;\n\n        dispatch(startSaveNote(activeNote));\n\n        Swal.close();\n    }\n}\n\nexport const startDeleting = (id) => {\n    return async(dispatch, getState) => {\n        const uid = getState().auth.uid;\n        await db.doc(`${uid}/journal/notes/${id}`).delete();\n\n        dispatch( deleteNote(id));\n    }\n}\n\nexport const deleteNote = (id) => ({\n    type: types.notesDelete,\n    payload: id\n});\n\nexport const noteLogout = () => ({\n    type: types.notesLogoutCleaning\n});"]},"metadata":{},"sourceType":"module"}